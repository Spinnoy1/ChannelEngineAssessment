@model ChannelEngine_Sheldon.BusinessLogic.Models.HomeViewModel
@{ Layout = "_Layout"; ViewBag.Title = "All Orders";}

<h2>All Orders</h2>
<a asp-action="AddReservation" class="btn btn-sm btn-primary">Update Stock</a>

<table class="table table-sm table-striped table-bordered m-2">
    <thead>
        <tr>
            <th>ProductName</th>
            <th>GTIN</th>
            <th>Quantity</th>
            <th>Set Stock Level</th>
            <th>Update Stock Level</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var o in Model.groupedProducts)
        {
        <tr>

            <td>@o.Description</td>
            <td>@o.Gtin</td>
            <td>@o.Quantity</td>
            <td><input type ="text" name ="StockLevel "id="@o.MerchantProductNo"/></td>
            <td>
                <input type="button" onclick="postStockLevel('@o.MerchantProductNo.ToString()', '@o.StockLocationId.ToString()', '@o.MerchantProductNo.ToString()')" /> 
                @*<a asp-action="UpdateStock" asp-route-MerchantProductNo="@o.MerchantProductNo" asp-route-StockLocationId="@o.StockLocationId" asp-route-StockLevel="StockLevel">
                    Set Stock Level to 25
                </a>*@
            </td>
        </tr>
        }
    </tbody>
</table>

<script type="text/javascript">
    var postStockLevel = function (merchantProductNo,stockLocationId, stockLevel) {
        var sl = document.getElementById(stockLevel).value;

        $.post('@Url.Action("UpdateStock", "Home")', { MerchantProductNo: merchantProductNo, StockLocationId: stockLocationId, StockLevel: sl });
    }
</script>